<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
  <script>
    (function(){var t=localStorage.getItem("gameHubTheme")||"dark";document.documentElement.classList.add("theme-"+t);try{var a=JSON.parse(localStorage.getItem("gameHubAccessibility")||"{}");var r=document.documentElement;if(a.bigText)r.classList.add("a11y-big-text");if(a.highContrast)r.classList.add("a11y-high-contrast");if(a.reduceMotion)r.classList.add("a11y-reduce-motion");if(a.focusVisible)r.classList.add("a11y-focus-visible");if(a.spacing)r.classList.add("a11y-spacing");}catch(e){}})();
  </script>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="theme-color" content="#1a1a2e">
  <meta name="description" content="××©×—×§ ××™×§×¡ ×¢×™×’×•×œ - PvP ××• × ×’×“ ×”××—×©×‘. ×©××•×ª ×©×—×§× ×™×, ×¨××•×ª ×§×•×©×™ ×•×˜×‘×œ×ª × ×¦×—×•× ×•×ª.">
  <meta property="og:title" content="××™×§×¡ ×¢×™×’×•×œ | Game Hub">
  <title>××™×§×¡ ×¢×™×’×•×œ | Game Hub</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Heebo:wght@400;600;700&display=swap" rel="stylesheet">
  <link rel="icon" type="image/svg+xml" href="../../../assets/favicon.svg">
  <link rel="stylesheet" href="../../../css/app.css">
  <link rel="stylesheet" href="./style.css">
  <script src="../../../js/auth.js"></script>
  <script src="../../../js/sounds.js"></script>
  <script src="../../../js/app-common.js"></script>
  <script src="./script.js" defer></script>
</head>
<body>
  <div class="app-topbar">
    <span id="appClock"></span>
    <div class="app-topbar-actions">
      <a href="../../home/index.html" class="app-icon-btn back-btn-mini" aria-label="×—×–×¨×”">â†</a>
      <button type="button" class="app-icon-btn" id="muteBtn" title="×”×©×ª×§/×”×¤×¢×œ ×¡××•× ×“" aria-label="×¡××•× ×“">ğŸ”Š</button>
      <button type="button" class="app-icon-btn" id="themeBtn" title="××¦×‘ ×‘×”×™×¨/×›×”×”" aria-label="×”×—×œ×£ ×ª××•×¨×”">ğŸŒ™</button>
      <button type="button" class="app-icon-btn" id="settingsBtn" title="×”×’×“×¨×•×ª" aria-label="×”×’×“×¨×•×ª">âš™</button>
    </div>
  </div>
  <div class="game-container">
    <h1>××™×§×¡ ×¢×™×’×•×œ</h1>
    <p class="player-badge" id="playerBadge"></p>
    
    <section id="playerNames" aria-label="×©××•×ª ×©×—×§× ×™×">
      <label for="playerXName">×©× ×©×—×§×Ÿ X</label>
      <input type="text" id="playerXName" placeholder="×”×›× ×¡ ×©×" autocomplete="name">
      <label for="playerOName">×©× ×©×—×§×Ÿ O</label>
      <input type="text" id="playerOName" placeholder="××—×©×‘" value="××—×©×‘" disabled aria-label="×©× ×©×—×§×Ÿ O">
    </section>
    
    <div id="scoreboard" role="status" aria-live="polite">
      <span id="scoreX">X: 0</span>
      <span id="scoreO">O: 0</span>
      <span id="scoreTie">×ª×™×§×•: 0</span>
    </div>
    <p id="gameStats" class="game-stats">××©×—×§×™×: 0 | × ×™×¦×—×•× ×•×ª: 0%</p>
    
    <button type="button" id="showTttHelp" class="btn-help" title="×¢×–×¨×”" aria-label="×”×¦×’ ×¢×–×¨×”">?</button>
    <div id="modeSelector">
      <label for="gameMode">××¦×‘ ××©×—×§</label>
      <select id="gameMode" aria-label="×‘×—×¨ ××¦×‘ ××©×—×§">
        <option value="pvp" selected>×©×—×§×Ÿ ××•×œ ×©×—×§×Ÿ</option>
        <option value="pvc">×©×—×§×Ÿ ××•×œ ××—×©×‘</option>
      </select>
      <label for="aiLevel" id="aiLevelLabel" class="hidden">×¨××ª ×§×•×©×™</label>
      <select id="aiLevel" class="hidden" aria-label="×¨××ª ×§×•×©×™ ×”××—×©×‘">
        <option value="easy">×§×œ (××§×¨××™)</option>
        <option value="medium">×‘×™× ×•× ×™</option>
        <option value="hard" selected>×§×©×” (×‘×œ×ª×™ ×× ×•×¦×—)</option>
      </select>
    </div>
    
    <div class="tictactoe" role="grid" aria-label="×œ×•×— ××©×—×§ ××™×§×¡ ×¢×™×’×•×œ">
      <button type="button" class="btn" data-index="0" aria-label="×ª× 1"></button>
      <button type="button" class="btn" data-index="1" aria-label="×ª× 2"></button>
      <button type="button" class="btn" data-index="2" aria-label="×ª× 3"></button>
      <button type="button" class="btn" data-index="3" aria-label="×ª× 4"></button>
      <button type="button" class="btn" data-index="4" aria-label="×ª× 5"></button>
      <button type="button" class="btn" data-index="5" aria-label="×ª× 6"></button>
      <button type="button" class="btn" data-index="6" aria-label="×ª× 7"></button>
      <button type="button" class="btn" data-index="7" aria-label="×ª× 8"></button>
      <button type="button" class="btn" data-index="8" aria-label="×ª× 9"></button>
    </div>
    
    <div id="controls">
      <button id="resetBtn" type="button" title="××™×¤×•×¡ ××©×—×§ ×•×ª×•×¦××•×ª"><span class="btn-icon">â†»</span> ××™×¤×•×¡ ××©×—×§</button>
      <button id="stopBtn" type="button" title="×¢×¦×•×¨ ××©×—×§"><span class="btn-icon">â¸</span> ×¢×¦×•×¨</button>
      <button id="victoryTableBtn" type="button" title="×”×¦×’ ×˜×‘×œ×ª × ×¦×—×•× ×•×ª"><span class="btn-icon">ğŸ“Š</span> ×˜×‘×œ×ª × ×¦×—×•× ×•×ª</button>
    </div>
    
    <section id="victoryTable" class="hidden" aria-label="×˜×‘×œ×ª × ×¦×—×•× ×•×ª">
      <h2>×˜×‘×œ×ª × ×¦×—×•× ×•×ª</h2>
      <table>
        <thead>
          <tr>
            <th>×©×</th>
            <th>× ×¦×—×•× ×•×ª</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td id="playerXDisplay">X: <span id="playerXDisplayName">×©×—×§×Ÿ 1</span></td>
            <td id="scoreXDisplay">0</td>
          </tr>
          <tr>
            <td id="playerODisplay">O: <span id="playerODisplayName">××—×©×‘</span></td>
            <td id="scoreODisplay">0</td>
          </tr>
        </tbody>
      </table>
    </section>
    
  </div>
  <div id="tipsOverlay" class="tips-overlay">
    <div class="tips-content">
      <h2>××™×š ××©×—×§×™× ××™×§×¡ ×¢×™×’×•×œ?</h2>
      <p>×œ×—×¥ ×¢×œ ×ª× ×¨×™×§ ×›×“×™ ×œ×©×™× X ××• O. ×”××˜×¨×”: ×©×œ×•×©×” ×‘×¡×¨×’×œ (×× ×›×™, ××•×¤×§×™ ××• ××œ×›×¡×•× ×™).</p>
      <button type="button" id="closeTips">×”×‘× ×ª×™!</button>
    </div>
  </div>
  <div id="accessibilityModal" class="accessibility-modal">
    <div class="accessibility-content">
      <h3>âš™ ×”×’×“×¨×•×ª × ×’×™×©×•×ª</h3>
      <div class="accessibility-section">
        <h4>×ª×¦×•×’×”</h4>
        <label><input type="checkbox" id="optBigText"> ×˜×§×¡×˜ ×’×“×•×œ ×™×•×ª×¨</label>
        <label><input type="checkbox" id="optHighContrast"> × ×™×’×•×“×™×•×ª ×’×‘×•×”×”</label>
        <label><input type="checkbox" id="optSpacing"> ×¨×™×•×•×— ××•×’×‘×¨</label>
      </div>
      <div class="accessibility-section">
        <h4>××™× ×˜×¨××§×˜×™×‘×™×•×ª</h4>
        <label><input type="checkbox" id="optReduceMotion"> ×”×¤×—×ª×ª ×× ×™××¦×™×•×ª</label>
        <label><input type="checkbox" id="optFocusVisible"> ×”×“×’×©×ª ×¤×•×§×•×¡ ××§×œ×“×ª</label>
      </div>
      <button type="button" class="btn-close-modal" onclick="document.getElementById('accessibilityModal').classList.remove('active')">×¡×’×•×¨</button>
    </div>
  </div>
  <script>
    (function() {
      var user = null;
      if (typeof AUTH !== "undefined") user = AUTH.getLoggedUser();
      if (user && typeof APP !== "undefined" && APP.checkSessionTimeout && APP.checkSessionTimeout()) {
        window.location.href = "../../login/index.html?return=ttt";
        return;
      }
      var badge = document.getElementById("playerBadge");
      var nameInput = document.getElementById("playerXName");
      if (user) {
        nameInput.value = user.name;
        badge.textContent = "×©×œ×•×, " + user.name + "!";
      } else {
        nameInput.placeholder = "××•×¨×— (×”×›× ×¡ ×©×)";
        badge.textContent = "××©×—×§ ×›××•×¨×—";
      }
      badge.style.display = "block";
      APP && APP.init();
      APP && APP.updateActivity();
      document.getElementById("themeBtn").addEventListener("click", function() {
        const theme = APP.getTheme() === "dark" ? "light" : "dark";
        APP.setTheme(theme);
        this.textContent = theme === "dark" ? "ğŸŒ™" : "â˜€ï¸";
      });
      if (APP.getTheme() === "light") document.getElementById("themeBtn").textContent = "â˜€ï¸";
      document.getElementById("muteBtn").addEventListener("click", function() {
        const m = SOUNDS.toggleMute();
        this.textContent = m ? "ğŸ”‡" : "ğŸ”Š";
      });
      if (SOUNDS && SOUNDS.isMuted()) document.getElementById("muteBtn").textContent = "ğŸ”‡";
      document.getElementById("settingsBtn").addEventListener("click", function() {
        document.getElementById("accessibilityModal").classList.toggle("active");
      });
      var tips = document.getElementById("tipsOverlay");
      var helpBtn = document.getElementById("showTttHelp");
      if (helpBtn) helpBtn.addEventListener("click", function() { tips.classList.add("active"); });
      document.getElementById("closeTips").addEventListener("click", function() {
        tips.classList.remove("active");
      });
    })();
  </script>
</body>
</html>
