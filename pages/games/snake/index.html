<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
  <script>
    (function(){var t=localStorage.getItem("gameHubTheme")||"dark";document.documentElement.classList.add("theme-"+t);try{var a=JSON.parse(localStorage.getItem("gameHubAccessibility")||"{}");var r=document.documentElement;if(a.bigText)r.classList.add("a11y-big-text");if(a.highContrast)r.classList.add("a11y-high-contrast");if(a.reduceMotion)r.classList.add("a11y-reduce-motion");if(a.focusVisible)r.classList.add("a11y-focus-visible");if(a.spacing)r.classList.add("a11y-spacing");if(a.largeCursor)r.classList.add("a11y-large-cursor");if(a.underlineLinks)r.classList.add("a11y-underline-links");if(a.dyslexiaFont)r.classList.add("a11y-dyslexia");}catch(e){}})();
  </script>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="theme-color" content="#0f172a">
  <meta name="description" content="××©×—×§ × ×—×© ×§×œ××¡×™ ×¢× ×˜×™×™××¨, × ×™×§×•×“, ×˜×‘×œ×ª ××•×‘×™×œ×™× ×•×›×¤×ª×•×¨×™ ××’×¢ ×œ××•×‘×™×™×œ.">
  <meta property="og:title" content="× ×—×© | Game Hub">
  <link rel="icon" type="image/svg+xml" href="../../../assets/favicon.svg">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Heebo:wght@400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="../../../css/app.css">
  <link rel="stylesheet" href="./style.css">
  <script src="../../../js/auth.js"></script>
  <script src="../../../js/sounds.js"></script>
  <script src="../../../js/standalone.js"></script>
  <script src="../../../js/app-common.js"></script>
  <title>× ×—×© | Game Hub</title>
</head>
<body>
  <div class="app-topbar">
    <span id="appClock"></span>
    <div class="app-topbar-actions">
      <a href="../../home/index.html" class="app-icon-btn back-btn-mini" aria-label="×—×–×¨×”">â†</a>
      <button type="button" class="app-icon-btn avatar-btn-mini" id="avatarBtn" title="×‘×—×¨ ××•×•×˜××¨" aria-label="×‘×—×¨ ××•×•×˜××¨">ğŸ‘¤</button>
      <button type="button" class="app-icon-btn" id="muteBtn" title="×¡××•× ×“" aria-label="×¡××•× ×“">ğŸ”Š</button>
      <button type="button" class="app-icon-btn" id="themeBtn" title="××¦×‘ ×‘×”×™×¨/×›×”×”" aria-label="×”×—×œ×£ ×ª××•×¨×”">ğŸŒ™</button>
      <button type="button" class="app-icon-btn" id="settingsBtn" title="×”×’×“×¨×•×ª" aria-label="×”×’×“×¨×•×ª">âš™</button>
    </div>
  </div>
  <div class="snake-container">
    <button type="button" id="showSnakeHelp" class="btn-help" title="×¢×–×¨×”" aria-label="×”×¦×’ ×¢×–×¨×”">?</button>
    <h1>××©×—×§ ×¡× ×™×™×§</h1>
    <p class="player-badge" id="playerBadge"></p>
    <div id="gameInfo" role="status" aria-live="polite">
      <span id="scoreDisplay">× ×™×§×•×“: 0</span>
      <span id="timerDisplay">×–××Ÿ: 0</span>
    </div>
    <div id="snakeDifficulty">
      <label for="speedSelect">××”×™×¨×•×ª:</label>
      <select id="speedSelect" aria-label="×¨××ª ×§×•×©×™">
        <option value="120">××™×˜×™</option>
        <option value="85" selected>×‘×™× ×•× ×™</option>
        <option value="55">××”×™×¨</option>
      </select>
    </div>
    <p class="shortcuts-hint">R ××™×¤×•×¡ â€¢ P ×”×©×”×™×” â€¢ ×—×¦×™× / WASD</p>
    <div class="canvas-wrap">
      <canvas id="gameCanvas" width="400" height="400" aria-label="×œ×•×— ××©×—×§ × ×—×©"></canvas>
      <div id="startOverlay" class="start-overlay">
        <div class="overlay-inner">
          <span class="overlay-icon" aria-hidden="true">ğŸ</span>
          <h2 id="overlayTitle">××•×›×Ÿ ×œ×”×ª×—×™×œ?</h2>
          <p class="overlay-desc">×—×¦×™× ××• WASD ×œ×›×™×•×•×Ÿ â€¢ Enter ×œ×”×ª×—×œ×”</p>
          <button type="button" id="btnStartOverlay" class="btn-overlay-start">
            <span>â–¶</span> ×”×ª×—×œ ××©×—×§
          </button>
        </div>
      </div>
    </div>
    <div id="controls">
      <button type="button" id="btnStart" class="btn-start" title="×”×ª×—×œ ××©×—×§"><span>â–¶</span> ×”×ª×—×œ</button>
      <button type="button" id="btnStop" class="btn-stop" title="×”×©×”×”"><span>â¸</span> ×¢×¦×•×¨</button>
      <button type="button" id="btnReset" class="btn-reset" title="××™×¤×•×¡"><span>â†»</span> ××™×¤×•×¡</button>
    </div>
    <div id="touchControls" class="touch-controls">
      <button type="button" class="touch-btn" data-dir="UP" aria-label="×œ××¢×œ×”">â–²</button>
      <div class="touch-row">
        <button type="button" class="touch-btn" data-dir="LEFT" aria-label="×©×××œ×”">â—€</button>
        <span></span>
        <button type="button" class="touch-btn" data-dir="RIGHT" aria-label="×™××™× ×”">â–¶</button>
      </div>
      <button type="button" class="touch-btn" data-dir="DOWN" aria-label="×œ××˜×”">â–¼</button>
    </div>
    <div id="leaderboardBox">
      <h2>×˜×‘×œ×ª ××•×‘×™×œ×™×</h2>
      <table id="leaderboard">
        <thead>
          <tr><th>××§×•×</th><th>×©×</th><th>× ×™×§×•×“</th></tr>
        </thead>
        <tbody id="leaderboardBody"></tbody>
      </table>
    </div>
  </div>
  <div id="avatarModal" class="accessibility-modal">
    <div class="accessibility-content">
      <h3>×‘×—×¨ ××•×•×˜××¨</h3>
      <div class="avatar-picker" id="avatarPicker">
        <button type="button" class="avatar-opt" data-emoji="ğŸ‘¤">ğŸ‘¤</button>
        <button type="button" class="avatar-opt" data-emoji="ğŸ˜Š">ğŸ˜Š</button>
        <button type="button" class="avatar-opt" data-emoji="ğŸ˜">ğŸ˜</button>
        <button type="button" class="avatar-opt" data-emoji="ğŸ®">ğŸ®</button>
        <button type="button" class="avatar-opt" data-emoji="â­">â­</button>
        <button type="button" class="avatar-opt" data-emoji="ğŸ">ğŸ</button>
        <button type="button" class="avatar-opt" data-emoji="â­•">â­•</button>
        <button type="button" class="avatar-opt" data-emoji="ğŸš€">ğŸš€</button>
      </div>
      <button type="button" class="btn-close-modal" onclick="document.getElementById('avatarModal').classList.remove('active')">×¡×’×•×¨</button>
    </div>
  </div>
  <div id="tipsOverlay" class="tips-overlay" role="dialog" aria-labelledby="tipsTitle" aria-modal="true">
    <div class="tips-content">
      <h2 id="tipsTitle">××™×š ××©×—×§×™× × ×—×©?</h2>
      <p><strong>××˜×¨×”:</strong> ×œ××›×•×œ ××ª ×”×ª×¤×•×—×™× (ğŸ”´) ×•×œ×¦×‘×•×¨ × ×™×§×•×“. ×”× ×—×© ××ª××¨×š ×‘×›×œ ××›×™×œ×”.</p>
      <p><strong>×©×œ×™×˜×”:</strong> ×—×¦×™× ××• WASD ×œ×”× ×¢×ª ×”× ×—×©. ×”×™×× ×¢ ××¤×’×™×¢×” ×‘×§×™×¨×•×ª ×•×‘×’×•×£ ×”× ×—×© ×¢×¦××•!</p>
      <p><strong>×§×™×¦×•×¨×™ ×“×¨×š:</strong> R ×œ××™×¤×•×¡ â€¢ P ×œ×”×©×”×™×”. ×‘××•×‘×™×™×œ â€“ ×”×©×ª××© ×‘×›×¤×ª×•×¨×™ ×”××’×¢.</p>
      <p><strong>××”×™×¨×•×ª:</strong> ×‘×—×¨ ×¨××ª ×§×•×©×™ (××™×˜×™/×‘×™× ×•× ×™/××”×™×¨) ×œ×¤× ×™ ×”×”×ª×—×œ×”.</p>
      <button type="button" id="closeTips">×”×‘× ×ª×™!</button>
    </div>
  </div>
  <div id="accessibilityModal" class="accessibility-modal">
    <div class="accessibility-content">
      <h3>â™¿ ×”×’×“×¨×•×ª × ×’×™×©×•×ª</h3>
      <div class="accessibility-section"><h4>×ª×¦×•×’×”</h4>
        <label><input type="checkbox" id="optBigText"> ×˜×§×¡×˜ ××•×’×“×œ</label>
        <label><input type="checkbox" id="optHighContrast"> × ×™×’×•×“×™×•×ª ×’×‘×•×”×”</label>
        <label><input type="checkbox" id="optSpacing"> ×¨×™×•×•×— ××•×’×‘×¨</label>
        <label><input type="checkbox" id="optUnderlineLinks"> ×§×• ×ª×—×ª×•×Ÿ ×œ×§×™×©×•×¨×™×</label>
        <label><input type="checkbox" id="optDyslexiaFont"> ×’×•×¤×Ÿ ×œ×“×™×¡×œ×§×¡×™×”</label>
      </div>
      <div class="accessibility-section"><h4>××™× ×˜×¨××§×¦×™×”</h4>
        <label><input type="checkbox" id="optReduceMotion"> ×”×¤×—×ª×ª ×× ×™××¦×™×•×ª</label>
        <label><input type="checkbox" id="optFocusVisible"> ×”×“×’×©×ª ×¤×•×§×•×¡ ××§×œ×“×ª</label>
        <label><input type="checkbox" id="optLargeCursor"> ×¡××Ÿ ×¢×›×‘×¨ ××•×’×“×œ</label>
      </div>
      <button type="button" class="btn-close-modal" onclick="this.closest('.accessibility-modal').classList.remove('active')">×¡×’×•×¨</button>
    </div>
  </div>
  <script src="./script.js"></script>
  <script>
    (function() {
      var user = null;
      if (typeof AUTH !== "undefined") user = AUTH.getLoggedUser();
      if (!user) {
        window.location.href = "../../login/index.html?return=snake";
        return;
      }
      if (typeof APP !== "undefined" && APP.checkSessionTimeout && APP.checkSessionTimeout()) {
        window.location.href = "../../login/index.html?return=snake";
        return;
      }
      var badge = document.getElementById("playerBadge");
      if (badge) {
        badge.textContent = "×©×œ×•×, " + user.name + "!";
        badge.style.display = "block";
        window.__loggedUserName = user.name;
      }
      var avatarBtn = document.getElementById("avatarBtn");
      if (avatarBtn && typeof AUTH !== "undefined") {
        avatarBtn.textContent = user.avatar || "ğŸ‘¤";
        avatarBtn.addEventListener("click", function() {
          var m = document.getElementById("avatarModal");
          if (m) m.classList.add("active");
        });
      }
      document.querySelectorAll("#avatarPicker .avatar-opt").forEach(function(btn) {
        btn.addEventListener("click", function() {
          var em = this.getAttribute("data-emoji");
          if (typeof AUTH !== "undefined" && em) {
            AUTH.updateAvatar(em);
            var ab = document.getElementById("avatarBtn");
            if (ab) ab.textContent = em;
          }
          var m = document.getElementById("avatarModal");
          if (m) m.classList.remove("active");
        });
      });
      if (typeof APP !== "undefined") {
        APP.init();
        APP.updateActivity();
        var muteBtn = document.getElementById("muteBtn");
        if (muteBtn && typeof SOUNDS !== "undefined") {
          muteBtn.addEventListener("click", function() {
            var m = SOUNDS.toggleMute();
            this.textContent = m ? "ğŸ”‡" : "ğŸ”Š";
          });
          if (SOUNDS.isMuted()) muteBtn.textContent = "ğŸ”‡";
        }
        var settingsBtn = document.getElementById("settingsBtn");
        if (settingsBtn) settingsBtn.addEventListener("click", function() {
          var m = document.getElementById("accessibilityModal");
          if (m) m.classList.toggle("active");
        });
      }
      var tips = document.getElementById("tipsOverlay");
      var helpBtn = document.getElementById("showSnakeHelp");
      if (helpBtn && tips) helpBtn.addEventListener("click", function() { tips.classList.add("active"); });
      var closeTips = document.getElementById("closeTips");
      if (closeTips && tips) closeTips.addEventListener("click", function() { tips.classList.remove("active"); });
    })();
  </script>
</body>
</html>
